<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Sign in</title>
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid justify-content-center text-center">
                <ul class="nav">
                    <li class="nav-item">
                      <a class="navbar-brand" href="#">oluyo's</a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>
    <section>
        <section>
            <div class="w-50 justify-content-center text-center container-fluid">
                <form action="" class="p-3">
                    <label for="email">Email</label>  
                    <input type="text" id="e_mail" name="email" class="form-control" placeholder="Enter your email">
    
                    <label for="password">Password</label>
                    <input type="text" id="pass_word" name="password" class="form-control" placeholder="Enter your password">
                </form>
                <button class="btn btn-dark" onclick="check_user()">Sign in</button>
                <h6>Don't have an account ? <a href="./index.html">Sign up</a></h6>
            </div>
        </section>
    </section>
</body>
<script>

    var current_user = JSON.parse(localStorage.getItem('current_user'))
    
    if(current_user){
        location.href = './dashboard.html'
    }

    if (all_users) {
        console.log("Users exist ðŸ˜")
    }else{
        window.location.href = './index.html'
    }

    if (bank_details) {

    }else{
        bank_details = []
        bank_info  = { 
            government_funds : 0,
            total_bank_general_income : 0,
            total_bank_owned_income : 0 ,
            total_number_of_users : 0
        }
        bank_details.push(bank_info)
        localStorage.setItem("bank_details" , JSON.stringify(bank_details))
    }
    if (transaction_history) {
        console.log("Transactions have been carried out ðŸ˜")
    }else{
        transaction_history = []
        localStorage.setItem("transaction_history" , JSON.stringify(transaction_history))
    }

    function check_user() {
        var all_users = JSON.parse(localStorage.getItem('user_details'))

        var find = all_users.find(user => user.email == e_mail.value) 

       
        if (find) {
            console.log(find.email)
            alert("User found ! ðŸ˜€ ")
            // find.last_login = last_login
            if (find.password == pass_word.value) {
                alert("Correct password ! ðŸ˜€ ")
                localStorage.setItem("user_details" , JSON.stringify(all_users))
                localStorage.setItem("current_user" , JSON.stringify(find))
                window.location.href = './dashboard.html'
            }else if (pass_word.value == "") {
                alert("Password field empty ! ðŸ˜¢ ")
            }else{
                alert("Wrong password ! ðŸ˜¢ ")
            }
        }else if (e_mail.value == "") {
            alert("Email field empty ! ðŸ˜¢ ")
        }else{
            alert("User \" " + e_mail.value + " \" does not exist")
        }
        
        // if (all_users) {
        //     if (email == users.email && password == users.password) {
        //         location.href = "./dashboard.html"
        //         console.log("Success")
        //     }else{
        //         console.log("Failure")
        //     }
        // }
        
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
</html>